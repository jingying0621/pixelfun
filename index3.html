<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>PixelFun! åƒç´ äº’åŠ¨ä¸–ç•Œ</title>
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: 'Press Start 2P', cursive;
      background: #111;
      color: #fff;
      overflow-x: hidden;
      position: relative;
    }
    h1, h2, h3, p, button, input {
      font-family: 'Press Start 2P', cursive;
    }
    section {
      padding: 60px 20px;
      text-align: center;
    }
    .hero {
      background: #222;
      padding: 100px 20px;
      color: #ffcc00;
    }
    .hero button {
      margin-top: 20px;
      padding: 12px 24px;
      font-size: 16px;
      border: 4px solid #ffcc00;
      background: #111;
      color: #ffcc00;
      cursor: pointer;
      transition: transform 0.2s;
    }
    .hero button:hover {
      transform: scale(1.1);
    }
    .shop-grid {
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
      justify-content: center;
      margin-top: 30px;
    }
    .shop-item {
      background: #222;
      padding: 20px;
      border: 4px solid #00ffff;
      color: #fff;
      width: 150px;
      text-align: center;
    }
    .shop-item button {
      margin-top: 10px;
      background: #111;
      color: #00ffff;
      border: 2px solid #00ffff;
      padding: 6px 10px;
      cursor: pointer;
    }
    .inventory {
      margin-top: 30px;
      background: #222;
      padding: 20px;
      max-width: 400px;
      margin-left: auto;
      margin-right: auto;
      border: 4px solid #ffcc00;
    }
    .inventory ul {
      list-style: none;
      padding: 0;
    }
    .inventory li {
      margin: 10px 0;
    }
    .theme-toggle {
      position: fixed;
      right: 20px;
      bottom: 20px;
      background: #222;
      color: #fff;
      border: 2px solid #fff;
      padding: 10px;
      cursor: pointer;
    }
    .light {
      background: #fff;
      color: #111;
    }
    .sparkle {
      position: absolute;
      width: 12px;
      height: 12px;
      background: yellow;
      animation: float 1s ease-out forwards;
      border-radius: 50%;
      pointer-events: none;
    }
    @keyframes float {
      to {
        opacity: 0;
        transform: translateY(-100px) scale(1.5);
      }
    }
  </style>
</head>
<body onclick="spawnSparkle(event)">

  <!-- å¼€å§‹ç•Œé¢ -->
  <section class="hero">
    <h1>ğŸ® PixelFun ä¸–ç•Œ</h1>
    <p>ç‚¹ä¸€ä¸‹å¼€å§‹ä½ çš„åƒç´ å†’é™©ï¼</p>
    <button onclick="startGame()">ç‚¹å‡»å¼€å§‹</button>
  </section>

  <!-- æ¸¸æˆå†…å®¹ -->
  <div id="game" style="display: none;">
    <section>
      <h2>ğŸ’° æˆ‘çš„é‡‘å¸</h2>
      <p id="coinCount">é‡‘å¸ï¼š0</p>
    </section>
    <section id="petContainer" style="margin-top: 40px; text-align: center;">
      <h2>ğŸ± å°çŒ«</h2>
      <div style="margin-bottom: 8px; color: #ffcc00;" id="happiness">å¿«ä¹å€¼ï¼š0</div>
      <img id="petImage" src="https://i.imgur.com/727liQg.png" alt="å°çŒ«" width="80" />
      <div>
        <button onclick="feedPet()" style="margin-top: 10px; font-size: 20px; background: #444; color: #fff; border: 2px solid #ffcc00; padding: 6px 12px; cursor: pointer;">
          å–‚é£Ÿ ğŸŸ
        </button>
      </div>
    </section>

    <section>
      <h2>ğŸ›’ åƒç´ å•†åº—</h2>
      <div class="shop-grid">
        <div class="shop-item">
          <p>ğŸª åƒç´ é¥¼å¹²</p>
          <button onclick="buyItem(this, 'ğŸª åƒç´ é¥¼å¹²', 5)">5 é‡‘å¸è´­ä¹°</button>
        </div>
        <div class="shop-item">
          <p>ğŸ§ƒ åƒç´ æœæ±</p>
          <button onclick="buyItem(this, 'ğŸ§ƒ åƒç´ æœæ±', 8)">8 é‡‘å¸è´­ä¹°</button>
        </div>
        <div class="shop-item">
          <p>ğŸ® æ¸¸æˆå¾½ç« </p>
          <button onclick="buyItem(this, 'ğŸ® æ¸¸æˆå¾½ç« ', 10)">10 é‡‘å¸è´­ä¹°</button>
        </div>
      </div>
    </section>

    <section class="inventory">
      <h2>ğŸ’ æˆ‘çš„èƒŒåŒ…</h2>
      <ul id="inventoryList">
        <li>ï¼ˆç©ºç©ºå¦‚ä¹Ÿï¼‰</li>
      </ul>
    </section>
  </div>

  <!-- éŸ³æ•ˆèµ„æº -->
  <audio id="buySuccess" src="https://files.catbox.moe/qd0a5c.mp3"></audio>
  <audio id="buyFail" src="https://files.catbox.moe/oymh74.mp3"></audio>
  <audio id="meowSound" src="https://files.catbox.moe/44ow24.mp3"></audio>
  <audio id="evolveSound" src="https://files.catbox.moe/fgtz4k.mp3"></audio>

  <!-- èƒŒæ™¯éŸ³ä¹æ’­æ”¾å™¨ -->
  <audio id="bgm" loop></audio>
  <button id="musicToggle" style="position: fixed; bottom: 80px; right: 20px; z-index: 999; background: #111; color: #fff; border: 2px solid #fff; font-size: 14px; padding: 10px; cursor: pointer;">
    ğŸ”Š
  </button>
  <button id="switchMusic" style="position: fixed; bottom: 140px; right: 20px; z-index: 999; background: #111; color: #fff; border: 2px solid #fff; font-size: 14px; padding: 10px; cursor: pointer;">
    ğŸµ åˆ‡æ¢éŸ³ä¹
  </button>

  <script>
    let coins = 49;
    let happiness = 0;
    let petStage = 0;
    const inventory = [];

    function startGame() {
      document.querySelector(".hero").style.display = "none";
      document.getElementById("game").style.display = "block";
      updateCoinsDisplay();
      updateInventory();
    }

    function updateCoinsDisplay() {
      document.getElementById("coinCount").textContent = `é‡‘å¸ï¼š${coins}`;
    }

    function spawnSparkle(e) {
      const sparkle = document.createElement('div');
      sparkle.className = 'sparkle';
      sparkle.style.left = `${e.pageX}px`;
      sparkle.style.top = `${e.pageY}px`;
      document.body.appendChild(sparkle);
      setTimeout(() => sparkle.remove(), 1000);
      coins++;
      updateCoinsDisplay();
    }

    function buyItem(button, itemName, price) {
      const successSound = document.getElementById("buySuccess");
      const failSound = document.getElementById("buyFail");

      if (inventory.includes(itemName)) {
        alert('ä½ å·²ç»æ‹¥æœ‰è¿™ä¸ªç‰©å“äº†ï¼');
        failSound.play();
        return;
      }
      if (coins >= price) {
        coins -= price;
        inventory.push(itemName);
        updateCoinsDisplay();
        updateInventory();
        button.textContent = 'âœ… å·²è´­ä¹°';
        button.disabled = true;
        button.style.background = '#555';
        successSound.play();
      } else {
        alert('é‡‘å¸ä¸è¶³ï¼');
        failSound.play();
      }
    }

    function updateInventory() {
      const list = document.getElementById("inventoryList");
      list.innerHTML = "";
      if (inventory.length === 0) {
        list.innerHTML = '<li>ï¼ˆç©ºç©ºå¦‚ä¹Ÿï¼‰</li>';
        return;
      }
      inventory.forEach(item => {
        const li = document.createElement("li");
        li.textContent = item;
        list.appendChild(li);
      });
    }

    function feedPet() {
      const meow = document.getElementById("meowSound");
      if (coins >= 3) {
        coins -= 3;
        happiness++;
        updateCoinsDisplay();
        document.getElementById("happiness").textContent = `å¿«ä¹å€¼ï¼š${happiness}`;
        updatePetImage();
        meow.play();
      } else {
        alert("é‡‘å¸ä¸è¶³ï¼Œæ— æ³•å–‚é£Ÿï¼");
      }
    }
    
    function updatePetImage() {
      const petImage = document.getElementById("petImage");
      const evolveSound = document.getElementById("evolveSound");

       // è¿›å…¥å–µç‹é˜¶æ®µ
      if (happiness >= 30 && petStage < 2) {
        petImage.src = "https://i.imgur.com/0ud9yXx.png"; // å–µç‹
        petStage = 2;
        evolveSound.play();
        alert("ğŸ‰ æ­å–œï¼å°å–µè¿›åŒ–æˆå–µç‹å•¦ï¼");
        // è¿›å…¥å°‘å¹´é˜¶æ®µ
      } else if (happiness >= 10 && petStage < 1) {
        petImage.src = "https://i.imgur.com/vK8yTup.png";// å°‘å¹´çŒ«
        petStage = 1;
        evolveSound.play();
        alert("âœ¨ å°å–µé•¿å¤§äº†ä¸€ç‚¹ï¼");
      } else if (happiness < 10 && petStage !== 0) {
        petImage.src = "https://i.imgur.com/727liQg.png";// å¹¼å¹´çŒ«
        petStage = 0;
      }
    }

    const musicTracks = [
      "https://files.catbox.moe/sag5ku.mp3",
      "https://files.catbox.moe/o4ru8e.mp3"
    ];
    let currentTrackIndex = 0;
    const bgm = document.getElementById('bgm');
    const toggleBtn = document.getElementById('musicToggle');
    const switchBtn = document.getElementById('switchMusic');

    window.addEventListener('click', () => {
      if (!bgm.src) {
        bgm.src = musicTracks[currentTrackIndex];
        bgm.volume = 0.3;
        bgm.play();
      }
    }, { once: true });

    toggleBtn.addEventListener('click', () => {
      if (bgm.paused) {
        bgm.play();
        toggleBtn.textContent = 'ğŸ”Š';
      } else {
        bgm.pause();
        toggleBtn.textContent = 'â¸';
      }
    });

    switchBtn.addEventListener('click', () => {
      currentTrackIndex = (currentTrackIndex + 1) % musicTracks.length;
      bgm.src = musicTracks[currentTrackIndex];
      bgm.play();
      toggleBtn.textContent = 'ğŸ”Š';
    });
  </script>
</body>
</html>
